<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zjgj.crm.mybatis.CrmCityMybatisDao">

	<resultMap id="RM_CrmCity" type="com.zjgj.crm.entity.CrmCity">
        <result property="cityId" column="city_id"/>
        <result property="cityCode" column="city_code"/>
        <result property="cityName" column="city_name"/>
        <result property="cityParent" column="city_parent"/>
        <result property="cityLevel" column="city_level"/>
        <result property="cityDsc" column="city_dsc"/>
        <result property="cityStat" column="city_stat"/>
        <result property="shtName" column="sht_name"/>
        <result property="mergeName" column="merge_name"/>
        <result property="zipCode" column="zip_code"/>
        <result property="cityLng" column="city_lng"/>
        <result property="cityLat" column="city_lat"/>
        <result property="pinyin" column="pinyin"/>
	</resultMap>
	
	<!-- 用于select查询公用抽取的列 -->
	<sql id="CrmCity_columns">
		city_id,city_code,city_name,city_parent,city_level,city_dsc,city_stat,sht_name,merge_name,zip_code,city_lng,city_lat,pinyin
	</sql>
	
	<!-- 添加 -->
	<insert id="save" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO crm_city (
        	city_id ,
        	city_code ,
        	city_name ,
        	city_parent ,
        	city_level ,
        	city_dsc ,
        	city_stat ,
        	sht_name ,
        	merge_name ,
        	zip_code ,
        	city_lng ,
        	city_lat ,
        	pinyin 
        ) VALUES (	
        	#{cityId} ,
        	#{cityCode} ,
        	#{cityName} ,
        	#{cityParent} ,
        	#{cityLevel} ,
        	#{cityDsc} ,
        	#{cityStat} ,
        	#{shtName} ,
        	#{mergeName} ,
        	#{zipCode} ,
        	#{cityLng} ,
        	#{cityLat} ,
        	#{pinyin} 
        )
	</insert>
    
	<!-- 修改 -->
	<update id="update" >
        UPDATE crm_city 
		<set>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityCode)">city_code = #{cityCode} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityName)">city_name = #{cityName} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityParent)">city_parent = #{cityParent} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityLevel)">city_level = #{cityLevel} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityDsc)">city_dsc = #{cityDsc} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityStat)">city_stat = #{cityStat} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(shtName)">sht_name = #{shtName} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(mergeName)">merge_name = #{mergeName} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(zipCode)">zip_code = #{zipCode} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityLng)">city_lng = #{cityLng} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityLat)">city_lat = #{cityLat} ,</if>
			<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(pinyin)">pinyin = #{pinyin} </if>
		</set>
        WHERE 
	        city_id = #{cityId} 
	</update>

	<!-- 删除 -->
    <delete id="delete">
		DELETE FROM crm_city WHERE
        city_id = #{id} 
    </delete>
	
	<!-- 批量删除 -->
	<delete id="batchDelete" parameterType="java.util.List">
        DELETE FROM  crm_city  WHERE
        city_id IN 
        <foreach item="item" collection="idsList" open="(" separator="," close=")">
#{item}		</foreach>  
    </delete>
    
	<!-- 根据主键获取对象 -->
    <select id="getByID" resultMap="RM_CrmCity">
		SELECT <include refid="CrmCity_columns" />
		FROM crm_city WHERE 
		city_id = #{id} 
	</select>
	
	<!-- 获取总条数 -->
	<select id="countAll" resultType="int">
        SELECT count(city_id) FROM crm_city 
    </select>
	
	<!-- 获取所有 -->
	<select id="findAll" resultMap="RM_CrmCity">
        SELECT <include refid="CrmCity_columns" /> 
		FROM crm_city 
    </select>
	
	<!-- 提取公共WHERE -->
	<sql id="CrmCity_where">
		<where>
			 
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityId)">
				AND city_id = #{cityId}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityCode)">
				AND city_code = #{cityCode}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityName)">
				AND city_name = #{cityName}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityParent)">
				AND city_parent = #{cityParent}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityLevel)">
				AND city_level = #{cityLevel}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityDsc)">
				AND city_dsc = #{cityDsc}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityStat)">
				AND city_stat = #{cityStat}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(shtName)">
				AND sht_name = #{shtName}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(mergeName)">
				AND merge_name = #{mergeName}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(zipCode)">
				AND zip_code = #{zipCode}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityLng)">
				AND city_lng = #{cityLng}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(cityLat)">
				AND city_lat = #{cityLat}
			</if>
	       <if test="@com.zjgj.crm.util.Ognl@isNotEmpty(pinyin)">
				AND pinyin = #{pinyin}
			</if>
		</where>
	</sql>
	
	<!-- 根据条件获取条数 -->
    <select id="findNumberByCondition" resultType="int">
        SELECT count(city_id) FROM crm_city 
		<include refid="CrmCity_where"/>    
    </select>
    
	<!-- 根据条件获取集合 -->
    <select id="findPageBreakByCondition" resultMap="RM_CrmCity">
    	SELECT <include refid="CrmCity_columns" />
	    FROM crm_city 
		<include refid="CrmCity_where"/>
		
		<if test="@com.zjgj.crm.util.Ognl@isNotEmpty(sortColumns)">
			ORDER BY ${sortColumns}
		</if>
    </select>
</mapper>

